@page
@model Blossom_RazorWeb.Pages.Profile.IndexModel
@{
    Layout = "_Layout";
    string role = HttpContext.Session.GetString("Role");

    if (role == null)
    {
        Response.Redirect("/auth/login");
        TempData["NotPermissionMessage"] = "Vui lòng đăng nhập";
    }
}
<div class="container mt-5">
    
    <form method="post" enctype="multipart/form-data">
        <div class="d-flex align-items-start">
            <!-- Avatar Section -->
            

            <div class="avatar-section me-4" style="width: 40%">
                <h2>User Profile</h2>
                <img id="avatarPreview"
                     src="@Model.Account.Avatar"
                     alt="Avatar Preview"
                     class="rounded-circle mt-3"
                     width="150"
                     height="150"
                     style="display: @(string.IsNullOrEmpty(Model.Account.Avatar) ? "none" : "block");" />
                <input style="width: 105px; margin-top: 12px" type="file" asp-for="AvatarFile" class="form-control-file" id="uploadImage" accept="image/*" onchange="previewAvatarImage(event)" />
                <div class="mt-3">
                    <p><b>Role: </b> @HttpContext.Session.GetString("Role")</p>
                </div>

            </div>

            <!-- Profile Info Section -->
            <div class="w-100">
                <div class="form-group">
                    <label>Full Name</label>
                    <input asp-for="Account.FullName" class="form-control" />
                </div>

                <div class="form-group mt-3">
                    <label>Email</label>
                    <input asp-for="Account.Email" class="form-control" readonly />
                </div>

                <div class="form-group mt-3">
                    <label>Gender</label>
                    <select asp-for="Account.Gender" class="form-control">
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group mt-3">
                    <label>Address</label>
                    <input asp-for="Account.Address" class="form-control" />
                </div>

                <button type="submit" class="btn btn-primary mt-4">Update Profile</button>
            </div>
        </div>
    </form>
</div>

<script>
    function previewAvatarImage(event) {
        const input = event.target;
        const preview = document.getElementById("avatarPreview");

        if (input.files && input.files[0]) {
            const reader = new FileReader();

            reader.onload = function (e) {
                preview.src = e.target.result;
                preview.style.display = "block"; // Show preview image
            };

            reader.readAsDataURL(input.files[0]);
        } else {
            preview.src = ""; // Reset preview if no file selected
            preview.style.display = "none";
        }
    }
</script>

<style>
    .avatar-section {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

        .avatar-section img {
            border-radius: 50%;
            object-fit: cover;
        }

    .form-group {
        width: 100%;
    }

</style>